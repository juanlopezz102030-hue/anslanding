<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover">
  <title>CAYO – BIENVENIDO</title>
  <!-- (resto del head igual que antes, sin cambios) -->
</head>
<body>
  <!-- (contenido de tu página igual, hasta el script de pixel) -->

<!-- WhatsApp click tracking for Meta Pixel (Lead + Custom) con fix -->
<script>
(function () {
  function getWhatsAppAnchor(el){
    if (!el) return null;
    if (el.closest) return el.closest('a[href^="https://wa.me/"], a[href^="https://api.whatsapp.com/send"]');
    while (el && el !== document) {
      if (el.tagName === 'A' && (el.href.indexOf('https://wa.me/') === 0 || el.href.indexOf('https://api.whatsapp.com/send') === 0)) return el;
      el = el.parentNode;
    }
    return null;
  }
  function paramsFrom(url){
    var out = {}, keys = ['utm_source','utm_medium','utm_campaign','utm_content','utm_term'];
    try{
      var u = new URL(url);
      keys.forEach(function(k){ var v=u.searchParams.get(k); if(v) out[k]=v; });
    }catch(e){}
    return out;
  }
  function randomEventID(){
    try { return (crypto && crypto.randomUUID) ? crypto.randomUUID() : String(Date.now())+'-'+Math.random().toString(16).slice(2); }
    catch(e){ return String(Date.now())+'-'+Math.random().toString(16).slice(2); }
  }

  document.addEventListener('click', function(e){
    var a = getWhatsAppAnchor(e.target);
    if(!a || typeof fbq !== 'function') return;

    var eventID = randomEventID();
    var extras = paramsFrom(location.href);

    // ✅ Lead sin value/currency
    fbq('track', 'Lead', Object.assign({
      eventID: eventID,
      content_name: 'Registro WhatsApp',
      destination: 'whatsapp'
    }, extras));

    // ✅ Evento personalizado WhatsAppClick sin value/currency
    fbq('trackCustom', 'WhatsAppClick', Object.assign({
      eventID: eventID,
      content_name: 'Registro WhatsApp',
      destination: 'whatsapp'
    }, extras));

    if (!a.target || a.target === '_self') {
      e.preventDefault();
      var href = a.href;
      setTimeout(function(){ window.location.href = href; }, 140);
    }
  }, true);
})();
</script>

</body>
</html>
